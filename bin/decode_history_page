#!/usr/bin/env ruby

require 'minimed_rf'
require 'json'

if ARGV.length > 0
  data = File.read(ARGV[0])
  history_page = MinimedRF::HistoryPage.new(data)
  records = history_page.decode(nil, true)
  records.each do |r|
    puts JSON.pretty_generate(r.as_json)
  end
else
  puts "Usage: decode_history_page: datafile"
end
